# ループの合理性と自由度の両立（まとめ）

「講義 → 演習 → 暗記」のループは、理解・応用・記憶をバランスよく結びつける **最も効率的な学習サイクル** です。講義で学んだ知識を演習で確認し、間違えた部分を暗記カードで定着させることで、脳の仕組みに沿った"自然な成長"が生まれます。

一方で、すべてのユーザーが常に同じペースでループを回すわけではありません。「今日は問題だけやりたい」「時間があるから徹底的に講義を読みたい」など、学習の状況は人によって、そして日によって大きく異なります。

そのため Academy では、最短ルートとしての"ループ"を提示しつつ、同時に"講義だけ""演習だけ""暗記だけ"といった自由な学習行動も尊重する **二層構造の導線** を採用します。

これにより、

- 学習に迷う人には"最適なルート"を
- 自分のペースで進めたい人には"選べる自由"を

どちらも損なうことなく提供でき、幅広い学習者が継続しやすい環境が実現します。

## ① データ収集層（理解度の"材料"になるデータを集める）

まず、ユーザー理解度の分析はデータが揃わないと精度が出ません。よって必要な情報を明確にします。

### 集めるべきデータ（全て DB にすでに構造が存在）

#### 演習データ（`practice_answers`）

- 正答／誤答
- どの Topic に紐づく問題か
- 所要時間
- → **"理解度"の主要データ**

#### 暗記カードデータ（`flashcard_reviews`）

- Again / Normal / Easy
- 次回復習までの間隔
- → **"記憶の定着度"がわかる**

#### 教材閲覧データ（optional）

- どのセクションを読んだか
- 途中離脱か、最後まで読んだか
- → **"理解の準備状況"がわかる**

#### 学習時間（`user_daily_summaries`）

- → **"学習量の実績"**

## ② 分析層（理解度を 1 つのスコアに統合する）

次に、それらのデータを **Topic 単位** で整理します。すでに `user_mastery_scores` が用意されています。

### Mastery スコアの算出ロジック案（シンプルかつ強力）

```
mastery_score =
  (問題正答率 70%)
  + (暗記カード定着度 20%)
  + (最近の学習頻度 10%)
```

### 内訳イメージ

#### ① 問題正答率（過去 30 問など）

- 正答：+1
- 誤答：-1
- 最近の問題ほど重みを強くする

#### ② カード定着度

- Easy：+1
- Normal：±0
- Again：-1
- インターバルが伸びているカードは高評価

#### ③ 最近の学習頻度

- 直近の取り組みが少ない Topic は"忘れ"として軽微に下がる

→ **結果として Topic ごとに 0〜100 の理解度スコアが作れる。**

> ※ すでに DB 設計に `user_mastery_scores` があるので実装上はそこに反映。
> （スコアは毎回クエリ集計でも良いし、バッチ更新でも良い）

## ③ AI アドバイス層（理解度スコアをもとに言語化）

AI の役割は **"言語化"** と **"次の一手の提案"** です。数値そのものではなく、データ → 意味 → 行動に変換する担当。

### AI への入力（プロンプトに渡すデータ構造）

最低限で良いので、以下のような JSON を用意します。

```json
{
  "summary": {
    "studyMinutes": 25,
    "questions": 20,
    "correctRate": 75
  },
  "topics": [
    { "name": "解熱鎮痛薬", "mastery": 80 },
    { "name": "胃腸薬", "mastery": 40 },
    { "name": "かぜの諸症状", "mastery": 55 }
  ],
  "weakness": [
    { "name": "解熱鎮痛薬の副作用", "wrongCount": 3 },
    { "name": "アスピリンの禁忌", "wrongCount": 2 }
  ]
}
```

このように、"要約情報の塊"を AI に渡すことで十分な精度が出ます。

### AI が出すべき 3 点セット

#### ① 今日の総評（褒め＋状況）

**例：**
「今日は 20 問中 15 問正解し、特に『かぜの諸症状』の理解が大きく進んでいます。」

#### ② 具体的な弱点指摘

**例：**
「胃腸薬の副作用に関する問題で誤答が続いているため、明日の演習で重点的に出題します。」

#### ③ 次の一手

**例：**
「明日は『アスピリンの禁忌』カードを先に復習し、その後に第 2 章の軽い講義に進みましょう。」

## 最重要：分析スコア → タスク生成 → AI コメント の連携

実はこの連携がとてもシンプルです。

### Step 1：理解スコアを算出（バックエンド）

- Topic ごとの `user_mastery_scores` を更新
- 弱い Topic を抽出

### Step 2：翌日のタスク生成（バックエンド）

弱い Topic を元に

- 「講義：復習すべき節」
- 「演習：関連問題 3〜5 問」
- 「暗記：関連カード」

などを選出して task を作成

### Step 3：AI に"その日のデータ"を渡す（バックエンド or フロント）

- AI はユーザーに言葉としての意味づけを行う
- 「今日の成長」「明日の重点」を説明

### Step 4：UI 上で表示（フロント）

- 今日のフィードバック
- 明日のタスク
- 弱点の可視化

→ **これでループが成立する**

## 完全にまとめると

### 分析は数値化

（演習と暗記のログ → Topic 別スコア）

### タスク生成はアルゴリズム

（スコアの低い Topic ほど翌日優先）

### AI は"人間の言葉に翻訳"する役

（数値 → 意味 → 行動に変換）

この **三分割モデル** にすると、

- わかりやすく
- 実装しやすく
- 拡張しやすい

仕組みになります。

---

# LicenceHub Academy – 3 軸 × 細分類一覧

## ① 講義（学ぶ・理解する）

**目的：** 知識のインプット・体系理解

### A. 基本表示機能

- 講義一覧（章・節・Topic の階層構造）
- 講義詳細ページ（Markdown/赤シート対応）
- 関連画像・図表表示
- 進捗バー（章/全体）

### B. ナビゲーション機能

- 次/前のセクションへ移動
- 一覧へ戻る
- 「今日の講義」へショートカット

### C. 理解補助機能

- ハイライト機能（赤シート対応の強調部）
- 用語のポップアップ説明（後期追加）
- 章末の理解度ミニテスト（任意）

### D. 学習ログ系

- 閲覧完了ステータス
- 中断位置の保存（あとで続きから）
- 所要時間の自動記録

## ② 演習（解く・応用する）

**目的：** 理解度チェック・弱点特定・本番形式への慣れ

### A. 基本出題機能

- 4 択問題（1 問ごと）
- 正誤表示
- 解説表示（短文・詳細）
- 次の問題へ自動遷移

### B. 出題モード

- 今日のタスク（デイリー演習）
- 章別演習（特定分野）
- 弱点演習（正答率の低い Topic）
- ランダム演習（混合）
- 地域別演習（本番連動）
- 過去問セット（年度別）

### C. 記録・分析

- 問題別正答履歴
- Topic 別正答率
- セッション単位のスコア（正答率/所要時間）
- 推定理解度更新（`mastery_score`）

### D. 学習補助

- 間違えた問題の再チャレンジ
- 類題への誘導（Topic ベース）
- 該当講義へジャンプ
- 関連暗記カードへ誘導（後付け機能）

## ③ 暗記カード（覚える・定着）

**目的：** 語句・成分・禁忌などの長期記憶化

### A. 基本復習機能

- 表面（用語）表示
- 裏面（説明）反転
- Again / Normal / Easy の 3 段階評価
- 今日のカード枚数リスト

### B. 出題モード

- 今日のカード（Anki 式）
- Topic 別カード
- 重点カード（Again 多いもの）
- 完了カード履歴
- 全カードからランダム復習

### C. 間隔反復（SRS）関連

- 次回出題日の自動計算
- レビュー履歴の保存
- 定着度スコアの更新
- Easy 多いカードは間隔を延長
- Again 多いカードは前倒し出題

### D. 連携機能（最低限で OK）

- 間違えた問題の Topic → その Topic のカードを優先表示

> ※ 問題 × カード の完全一致は不要  
> ※ Topic レベルのゆるい紐づけで十分

## ④ 横断機能（全学習軸に共通）

ここは「ループの外側」にある重要なカテゴリです。

### A. タスク生成（デイリープラン）

- 今日のタスク（講義 → 演習 → 暗記）
- 推定所要時間計算
- 進捗度（%）
- 完了処理
- 翌日のタスク自動生成（弱点反映は後付け）

### B. 進捗管理

- 全体進捗バー
- 章別進捗
- Topic 別弱点一覧
- 学習日数・連続日数
- 累積演習数・カード枚数

### C. AI アドバイス（フィードバック）

- 今日の学習の要約
- 苦手 Topic の指摘
- 翌日の重点ポイント
- 成長実感の言語化（モチベ維持）

> ※ これは後付けで問題なし（データ揃ってからで OK）

### D. 自由学習導線

- 講義一覧へ
- 演習モードへ
- 暗記カード一覧へ
- 最近の学習履歴へ

---

## 最終まとめ（マップ構造）

```
1. 講義（理解）
   ├ 表示
   ├ ナビ
   ├ 理解補助
   └ 学習ログ

2. 演習（応用）
   ├ 基本出題
   ├ 出題モード
   ├ 記録・分析
   └ 弱点補強

3. 暗記カード（記憶）
   ├ 基本復習
   ├ 出題モード
   ├ 間隔反復
   └ Topic連携（軽め）

4. 横断機能（サイクル全体）
   ├ 今日のタスク
   ├ 進捗管理
   ├ AIアドバイス
   └ 自由学習導線
```

## この分類を作った目的

- **開発する機能を 主軸 → 小分類 → 実装単位 に落とせる**
- **MVP で必要な部分と後回しで良い部分が明確**
- **Cursor に渡す際の「優先度付け」に使える**
- **UI/UX を整理する際の視点が揃う**
